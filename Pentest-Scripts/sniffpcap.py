#A simple packet sniffer that saves the packets to a pcap file. These can be opened with Wireshark or Network Miner. As for the latter,
#the following command may also be useful. I'm putting it here because I keep forgetting it.
# tcpdump -i eth0 -s 0 -U -w - | nc remote_pc port


from scapy.all import *

pktdump = PcapWriter("file.pcap", append=True, sync=True)

def callback(pkt):
    pktdump.write(pkt)
    
    
sniff(prn=callback, store=0)
